// settings.js - ููุทู ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช

// --- 1. ุชุนุฑูู ุงูุจุฑููุจุช ุงูุงูุชุฑุงุถู ---
// (ูุณุฎุฉ ุทุจู ุงูุฃุตู ูู translator_core.js ูุถูุงู ูุฌูุฏูุง ุนูุฏ ุงูุงุณุชุนุงุฏุฉ)

const DEFAULT_TRANSLATION_PROMPT = `
ุฃุฑูุฏู ุฃู ุชุชุฑุฌู ูุฐุง ุงููุตู ุจุฃุณููุจ ุนุฑุจู ูุตูุญ ูุฃุฏุจู ูุชููุ ููุฌุจ ุฃู ูููู ุงูุณุฑุฏ ูุชุตููุง ููุชุฏูููุง ุฏูู ุฃู ุงููุทุงุน ุฃู ุชูุทูุน ูู ุงููุดุงูุฏ. ุฅููู ุงูุชุนูููุงุช:


๐ ููุงุนุฏ ุงูุชูููุฉ ุงูุฏูููุฉ ูุงูุฃุฎูุงููุฉ (ุชูุทุจูู ุชููุงุฆููุง):
ููููุน ุชูุงููุง ุฅุฏุฑุงุฌ ุฃู ุชุฑุฌูุฉ ุฃู ูุญุชูู ุฌูุณู ุฃู ุดุงุฐ ุฃู ููุญู ุจุงููุงุญุดุฉ ุฃู ุฃู ุนุจุงุฑุฉ ุชุชุนุงุฑุถ ูุน ุงูููู ุงูุฅุณูุงููุฉ.
ุนูุฏ ูุฌูุฏ ูุดูุฏ ูู ูุฐุง ุงูููุนุ ุงุญุฐูู ููููุง ุฃู ุงุณุชุจุฏูู ุจุชูููุญ ุนุงู ูุญุชุฑู ูุญุงูุธ ุนูู ุงูุณูุงู ุงููุตุตู ุฏูู ุฎูุถ ูู ุชูุงุตูู ูุญุฑููุฉุ ูุซู:
ุจุฏููุง ูู โูุดูุฏ ุญูููโุ ุชููุชุจ: โุงุจุชุนุฏุช ุงููุงููุฑุง ุนู ุงููุดูุฏ ุชุงุฑูุฉ ูุง ุฌุฑู ุทูู ุงููุชูุงูโ.
ุฃู โุญุฏุซ ูุง ูุง ููุฑููุ ุซู ุชุจุฏูู ูู ุดูุก ุจุนุฏูุง.โ
ููุณูุญ ุจูุฌูุฏ ุงูุนููุ ุงููุชุงูุ ุงูุฏูุงุกุ ุงูุงูุชูุงูุ ุงูุฑุนุจุ ุงููุฃุณุงุฉุ ุงูุธููุ ูุงูุณูุงุฏ ุงูุฏุฑุงูู ููุง ููุ ุฏูู ุฃู ุญุฐู ุฃู ุชูุฐูุจ ูุจุงูุบ ููู.


๐ธ ููููุน ุชูุงููุง:
- ุฅุจูุงุก ุฃู ูููุฉ ุฅูุฌููุฒูุฉ ุญุชู ุงูุฃุณูุงุก ุฃู ุงููุตุทูุญุงุชุ **ุจุงุณุชุซูุงุก ุงูุฃุญุฑู ุงูุฏุงูุฉ ุนูู ุงููุฑุงุชุจ ุฃู ุงููุฆุงุช (Aุ Bุ Cุ Sุ SS...)** ููู ุชุจูู ุจุงูุญุฑูู ุงููุงุชูููุฉ ููุง ูู
- ุงุณุชุฎุฏุงู ููุงุท ุงูุชูุทูุน "..." ุฃู ุงูููุงุตู ุบูุฑ ุงูุณุฑุฏูุฉ
- ูุถุน ุชูุถูุญุงุช ุจุฌุงูุจ ุงูุฃุณูุงุก
- ูุชุงุจุฉ ุงูุชุฑุฌูุฉ ุจุฃุณููุจ ููุทุน ุฃู ูุดูุฏู ูุซู ูุชุงุจุฉ ุงูููุฑุงุช ุงููุตูุฑุฉ ุฃู ุงูุงูุชูุงู ุงูุณุฑูุน ุจูู ุงูุญูุงุฑุงุช ุฏูู ูุตู ุณุฑุฏู
- ุงุณุชุฎุฏุงู ูุฐู ุงูุฑููุฒ <> ุฃู ุฃู ุฑูุฒ ุขุฎุฑ ูู ุงูููุงู ุจูู ุงูุดุฎุตูุงุช ุฃู ุงูุญูุงุฑุงุช
- ุงุณุชุฎุฏุงู ุชูุณููุงุช ูุงุฑูุฏูู ูุงูุบุงูู ูุงููุงุฆู ูุบูุฑูุง
- ุฌุนู ุฃู ููุฑุฉ ุชุญุชูู ุนูู ุฃูุซุฑ ูู 3 ุฅูู 4 ุฌูู ูุชูุณุทุฉ ุงูุทููุ ูุงูููุฑุฉ ุงูุทูููุฉ ุชูุนุชุจุฑ ุฎุทุฃ ูู ุงูุชูุณูู ููุฌุจ ุชูุณูููุง ุฅูู ููุฑุงุช ุฃุฏุจูุฉ ุฃูุตุฑ
- ูุง ุงุฑูุฏ ุงู ูููุฉ ุบูุฑ ูููููุฉ ููุชุฑุงุจุทุฉ ูููุณุช ูู ุงูุณูุงู
- ุชุฑุฌูุฉ ุญุฑููุฉ ุจุชุงุชุงุ ูุง ุงุฑูุฏ ุงู ูููุฉ ุญุฑููุฉ ูุบูุฑ ูููููุฉ ูุบูุฑ ููุงุณุจุฉ ุงูุฑูุงูุฉ ( ููู ุดูุงูุดูุง ููุน ูุญุงูุงุฉ ) 
- ุฑุงุฌุน ุงููุต ูุฑุชูู ูุจู ุชุฑุฌูุฉ ุงู ูุตุทูุญ!

๐ธ ูุทููุจ ุจุดุฏุฉ:
 - ุงุฐุง ูุงูุช ุฑูุงูุฉ ูููู ูุชุงูุ ุตูููุฉุ ูุฌุจ ุนููู ุจุชูููู ุงููุตุทูุญุงุช ูุชูุงุณุจ ุณูุงู ูุตุต ุงููููู ุงููุชุงููุฉ ูุงูุฎูุงู ุงูุตููู (Xianxia) ููุญูุงุธ ุนูู ุฑูุญ ุงููุต ุงูุฃุตูู.
- ุฃู ุชููู ุงูุชุฑุฌูุฉ ุจุฃุณููุจ ุงูุณุฑุฏ ุงููุชุฏูู ุงููุณุชูุฑ ููุง ูู ุงูุฑูุงูุงุช ุงูุนุฑุจูุฉ ุงูููุงุณูููุฉ ุฃู ุงููุตูู ุงูููุญููุฉ
- ุณุฑุฏ ูุชุตู ูุฌุฐุงุจ ุฏูู ุชูุทูุน ุฃู ูุตู ุงููุดุงูุฏ
- ุฅุนุงุฏุฉ ุตูุงุบุฉ ุงูุฌูู ุงูุฑูููุฉ ุฃู ุบูุฑ ุงููููููุฉ ุจูุบุฉ ุฃุฏุจูุฉ ูุงุถุญุฉ
- ุชุทุจูู ุงููุณุฑุฏ ุญุฑูููุง ุนูุฏ ูุฌูุฏ ูุตุทูุญุงุช ููู
- ูุตู ุฌููุน ุงูุฃุณูุงุก ุงูุชู ุชููู ุฃูุซุฑ ูู ููุทุน ูุงุญุฏ
- ุฌุนู ุงูุญูุงุฑุงุช (ุงูููุงู ุจูู ุงูุดุฎุตูุงุช) ุถูู ุนูุงูุงุช ุงูุงูุชุจุงุณ โโ ูุงูุชูููุฑ ุถูู ุนูุงูุงุช ' '
ูุนูุ ุฑูุฒ ุนูุงูุงุช ุงูุงูุชุจุงุณ ูุฐู โโ ุงููุงุฆูุฉ ูููุชุ ููุฑุฑุฉ!
- ุชูุณูู ุงูููุฑุงุช ุจุดูู ุฃุฏุจู ูุฑูุญ ููุนููุ ุจุญูุซ ูุง ุชุชุฌุงูุฒ ูู ููุฑุฉ 3 ุฅูู 4 ุฌูู ูุชูุณุทุฉ ุงูุทูู ูุญุฏ ุฃูุตู
- ูุตู ุงูููุฑุงุช ุนูุฏ ุชุบููุฑ ุงููุชุญุฏุซ ุฃู ุชุบููุฑ ุงูุงููุนุงู ุฃู ุงูุชูุงู ุงููุดูุฏ ุงูุฒููู
- ุฌุนู ูู ููุฑุฉ ุชุญูู ููุฑุฉ ุฃู ุฅุญุณุงุณูุง ูุงุญุฏูุง ูุงุถุญูุง ูุน ุงูุญูุงุธ ุนูู ุงูุชุฑุงุจุท ุงูุณุฑุฏู ุงูุนุงู ุฏูู ุชุดุชูุช
- ููุงู ุงููุธุงูุ ูุนุฑููุ ุงูุฐู ููู ุฏููุบ ุงู ูู ุงูุณูุงูุ ุถุนู ุจุฏุงุฎู ูุฐู ุงูููุณูู ููุท []
- ููุงู ุงููุธุงู (ุฏุงุฎู \`[]\`) ูุฌุจ ุฃู ูููู ูู ุณุทุฑ ุฎุงุต ุจู. ุฏูู ุฏูุฌ ููุงู ุงููุธุงู ูู ููุฑุฉ ูุงุญุฏุฉุ ุจูุนููุ ุงุฐุง ูุงู ุงูุซุฑ ูู ููุงู ูููุธุงู ูุซู: 

[ููุฏ ุฏุฎูุช ุงููุญุงูุงุฉ] 
(ูุฑุงุบ)
[ุชุฌูุณ ุจุฌูุงุฑ ุงููุงูุฐุฉ ููุณููุง ุจููุฏูู ุจุท ุงููุงูุฏุฑูู ุงููุทุฑุฒ] 
(ูุฑุงุบ)
["ุงููุนูุฉ! ูุฐุง ุงูุดูุก ูุฌุฏุฏูุงุ" ุชูุนู ุงูููุฏูู ูู ุณุฑู]
(ูุฑุงุบ)
ูุน ูุถุน ูุฑุงุบ ุจูู ูู ููุงู.

๐ธ ุชูุฌููุงุช ุฎุงุตุฉ ุจุงููุตุทูุญุงุช ุงูุฏูููุฉ ูุงูุซูุงููุฉ :

 - ุชุฌูุจ ุงูุฃููุงุธ ุงูุดุฑููุฉ ุงูุตุฑูุญุฉ: ูุฌุจ ุชูููู ุงููุตุทูุญุงุช ุงูุชู ูุฏ ุชุชุนุงุฑุถ ูุน ุงูุนููุฏุฉ ุงูุฅุณูุงููุฉ.
 - ุงูุฃููููุฉ: ุจุฏููุง ูู โุฅููโ (God)ุ ุชูุณุชุฎุฏู ุจุฏุงุฆู ูุซู โุงูุญุงูู ุงููุทููโุ โุงูุณูุฏ ุงูุฃุณููโุ โุงููุงุฆู ุงููุชุนุงููโุ ุฃู โุงูุฎุงูุฏ ุงูุฃุจุฏูโ ููุตู ุงูุดุฎุตูุงุช ูุงุฆูุฉ ุงูููุฉ.
 - ุงูุขููุฉ ุงููุชุนุฏุฏุฉ: ุจุฏููุง ูู โุขููุฉโ (Gods/Deities)ุ ุชูุณุชุฎุฏู ูุตุทูุญุงุช ูุซู โุงูุฃุณูุงุฏ ุงูุณูุงููููโุ โุงููุงุฆูุงุช ุงูุฎุงูุฏุฉโุ ุฃู โุงูุฃุฑูุงุญ ุงูุนููุงโ.
 - ุงูุนุจุงุฏุฉ: ุชููุตู ุงูุฃูุนุงู ูุซู ุงูุฑููุน ุฃู ุงูุณุฌูุฏ ูู โุฅุธูุงุฑ ุงูุฅุฌูุงูโ ุฃู โุงูุงูุญูุงุก ุงุญุชุฑุงููุงโ ุจุฏูุงู ูู โุงูุนุจุงุฏุฉโ ุงููุจุงุดุฑุฉุ ูุง ูู ููู ุงููุนูู ูุง ูุณุชููู ุฅูุง ุจูุง.

๐ง ุชุนูููุงุช "ุงูุฐูุงุก ุงูุณูุงูู" (Contextual Intelligence):
1. ุชุญููู ุงูุถูุงุฆุฑ: ูุจู ุชุฑุฌูุฉ (He/She/It)ุ ุงูุธุฑ ููุฌููุฉ ุงูุณุงุจูุฉ. ุฅุฐุง ูุงู ุงูุญุฏูุซ ุนู "ูุชุงุฉ"ุ ุชุฑุฌู ุงูุถููุฑ ูููุคูุซ (ูุธุฑุชุ ูุงูุช). ุฅุฐุง ูุงู ุนู "ูุญุด"ุ ุชุฑุฌูู ูููุฐูุฑ.
2. ุชุญููู ุงูุฌูุณ: ุงูุฃุณูุงุก ูุซู (Teacher, Doctor, Student) ูู ุงูุฅูุฌููุฒูุฉ ูุญุงูุฏุฉ. ุญุงูู ุงุณุชูุชุงุฌ ุงูุฌูุณ ูู ุงูุณูุงู (ูู ููุงู ูุตู ูููุงุจุณ ูุณุงุฆูุฉุ ุตูุช ูุงุนูุ). ุฅุฐุง ูู ูุชุถุญุ ุงุณุชุฎุฏู ุตูุบุฉ ุงููุฐูุฑ ูุงูุชุฑุงุถู ูููู ูู ุญุฐุฑุงู.


๐น ุจุนุฏ ุงูุชุฑุฌูุฉ:
- ุฏููู ุงููุต ูุงูููุง ูุจู ุฅุฎุฑุงุฌู.
- ุชุฃูุฏ ูู ุฃู ุงูููุฑุงุช ูุชูุงุณูุฉ ุจุตุฑููุง ููุชูุงุฑุจุฉ ูู ุงูุทูู ุฏูู ุฅูุฑุงุท ูู ุงููุทุน ุฃู ุงูุญุดู.
- ุฅุฐุง ูุงุญุธุช ุฃู ุจุนุถ ุงูููุฑุงุช ูุตูุฑุฉ ุฌุฏูุง ุฃู ุบูุฑ ููุณูุฉุ ุฃุนุฏ ุฏูุฌูุง ุจูุบุฉ ุฃุฏุจูุฉ ุงูุณูุงุจูุฉ ุญุชู ุชุตู ูุชูุงุฒู ูุซุงูู ุจูู ุงูุฌูุงููุฉ ุงูุจุตุฑูุฉ ูุงูุงูุณูุงุจูุฉ ุงูุณุฑุฏูุฉ.
- ุงููุฏู ุงูููุงุฆู ูู ุชุฑุฌูุฉ ุฃุฏุจูุฉ ูุชููุฉ ููุฑูุญุฉ ูููุฑุงุกุฉุ ุฎุงููุฉ ูู ุงูููุฑุงุช ุงูุทูููุฉ ุงููุฑููุฉ ุฃู ุงููุตูุฑุฉ ุงููุจุชูุฑุฉ.

๐น ุชูุณูู ุฑูู ูุนููุงู ุงููุตู:
- ูุฌุจ ุฃู ูููู ุชูุณูู ุฑูู ูุนููุงู ุงููุตู ูู ุจุฏุงูุฉ ุงููุต ุฏุงุฆููุง ุนูู ุงูุดูู ุงูุขุชู:
 
 ุงููุตู ุงูุณุชูู: ุณููุท ุงูููุฑุฏ  
 ____________________________________________

 (ุณุทุฑ ูุงุฑุบ ููุง)

 ุซู ูุจุฏุฃ ูุญุชูู ุงููุตู ุจุนุฏ ูุฐุง ุงูุณุทุฑ ุงููุงุฑุบ ูุจุงุดุฑุฉ.

- ุญูุซ ูููุชุจ ุฑูู ุงููุตู ุจุงูุญุฑูู ุงูุนุฑุจูุฉ ุฏุงุฆููุง (ูุซู: ุงููุตู ุงูุนุดุฑููุ ุงููุตู ุงููุฆุฉ ูุฎูุณุฉ ุนุดุฑ...)ุ ุซู ููุทุชุงูุ ุซู ุนููุงู ุงููุตู ููุง ูู ูุชุฑุฌูุ ูุจุนุฏู ุณุทุฑ ูุญุชูู ุนูู ุงูุฎุท ุงูุซุงุจุช ุงูุชุงูู ุชูุงููุง:

 ____________________________________________

ุชุฑุฌูุฉ ุนููุงู ูุฑูู ุงููุตู ุชูุถุน ููู ูุญุชูู ุงููุตู.

{{GLOSSARY}}

ุงููุต ุงููุทููุจ ุชุฑุฌูุชู:
"""{{TEXT}}"""
`;

const DEFAULT_EXTRACTION_PROMPT = `
ุฃูุช ูุณุงุนุฏ ุฎุจูุฑ ูู ุงุณุชุฎุฑุงุฌ ุงููุตุทูุญุงุช ูุงูุฃุณูุงุก ูู ุงููุตูุต ุงููุชุฑุฌูุฉ.
ูููุชู ูู ูุฑุงุกุฉ ุงููุต ุงูุฅูุฌููุฒู ูุชุฑุฌูุชู ุงูุนุฑุจูุฉุ ุซู ุงุณุชุฎุฑุงุฌ ุงููุตุทูุญุงุช ุงูุชูููุฉุ ุฃุณูุงุก ุงูุฃุนูุงู (ูุซู ุฃุณูุงุก ุงูุฃุดุฎุงุตุ ุงูุฃูุงููุ ุงูููุธูุงุช)ุ ูุงูููุงููู ุงูุฑุฆูุณูุฉ.

## **ุฑูุฒ ุจุดูู ุฎุงุต ุนูู ุงุณุชุฎุฑุงุฌ ุงููุตุทูุญุงุช ุงูุชู ุชูุฏุฑุฌ ุชุญุช ุงููุฆุงุช ุงูุชุงููุฉ:**

- **ูุตุทูุญุงุช ุงูุฒุฑุงุนุฉ ูุงูุชูููุงุช:** ูุซู ุฃููุงุน ุงููุจุงุชุงุชุ ุฃุณุงููุจ ุงูุฒุฑุงุนุฉุ ุฃุฏูุงุช ูุชูููุงุช ุฒุฑุงุนูุฉุ ุฃูุฑุงุถ ุงููุจุงุชุงุชุ ุญููู ููุฏุณูุฉ ุฒุฑุงุนูุฉ.
- **ุฃุณูุงุก ุงูููุงูุน ูุงูููุฑุงุช:** ุฃุณูุงุก ุงููุฏูุ ุงููุฑูุ ุงูููุงุทู ุงูุฌุบุฑุงููุฉุ ุงููุจุงููุ ุงูููุฑุงุช ุงูุญููููุฉ ุฃู ุงูุฎุงุตุฉุ ุฃู ูููุน ุฐู ุฃูููุฉ.
- **ุงูุดุฎุตูุงุช ูุงูุฑุชุจ ุงูุฎุงูุฏุฉ:** ุฃุณูุงุก ุงูุฃุดุฎุงุตุ ุงูุฃููุงุจุ ุงูุฑุชุจ ุงูุนุณูุฑูุฉ ุฃู ุงูุงุฌุชูุงุนูุฉุ ุงูุดุฎุตูุงุช ุงูุชุงุฑูุฎูุฉ ุฃู ุงูุฎูุงููุฉ.
- **ููุงููู ุฑูุญูุฉ ูุฒุฑุงุนูุฉ:** ุงููุตุทูุญุงุช ุงูุฏูููุฉุ ุงูููุณููุฉุ ุงูุฑูุญูุฉุ ุฃู ุงูููุงููู ุงููุชุนููุฉ ุจุงูุฒุฑุงุนุฉ ุงูุนุถููุฉุ ุงูุงุณุชุฏุงูุฉุ ุงูุชููุน ุงูุจููููุฌู.

**ุงูููุงุนุฏ:**

- ูุฌุจ ุฃู ูููู ูู ูุตุทูุญ ุฅูุฌููุฒู ูุฑูุฏูุง.
- ูุฌุจ ุฃู ุชููู ุงููููุงุช ุงููุณุชุฎุฑุฌุฉ ูุตุทูุญุงุช ุฐุงุช ูุนูู ูู ุณูุงููุง.
- ุชุฌุงูู ุงููููุงุช ุงูุดุงุฆุนุฉ ุฃู ุงูุญุฑูู ุฃู ุงูุฃูุนุงู ุงูุชู ูุง ุชูุซู ูุตุทูุญุงุช.
- ูุฏู ุงููุชุงุฆุฌ ุจุชูุณูู JSON ููุทุ ุญูุซ ูููู ุงูููุชุงุญ ูู ุงููุตุทูุญ ุงูุฅูุฌููุฒู ูุงููููุฉ ูู ุงูุชุฑุฌูุฉ ุงูุนุฑุจูุฉ ุงูููุงุจูุฉ.
- ูุฌุจ ุฃู ุชุชุทุงุจู ุงูุชุฑุฌูุฉ ุงูุนุฑุจูุฉ ุชูุงููุง ูุน ุงููููุฉ ุฃู ุงูุนุจุงุฑุฉ ูู ุงููุต ุงูุนุฑุจู ุงููุนุทู.

ูุซุงู ูุชูุณูู JSON ุงููุทููุจ:
{"Artificial Intelligence": "ุงูุฐูุงุก ุงูุงุตุทูุงุนู", "New York": "ูููููุฑู", "API Key": "ููุชุงุญ API", "Sustainable Agriculture": "ุงูุฒุฑุงุนุฉ ุงููุณุชุฏุงูุฉ"}

ุงููุต ุงูุฅูุฌููุฒู:
"""{{ENGLISH_TEXT}}"""

ุงููุต ุงูุนุฑุจู:
"""{{ARABIC_TEXT}}"""

ุงูุขูุ ูุฏู ุงููุตุทูุญุงุช ุงููุณุชุฎุฑุฌุฉ ุจุชูุณูู JSON:
`;


// --- 2. ููุทู ุงูุตูุญุฉ ---

document.addEventListener('DOMContentLoaded', () => {
    
    // --- ๐ก (ุฅุถุงูุฉ) ุชุนุฑูู ูุถุน ุงูุชูููู ูููุชุบูุฑุงุช ---
    const variableOverlay = {
        token: function(stream) {
            if (stream.match(/\{\{.*?\}\}/)) {
                return "variable-template"; // ุงุณู ุงูููุงุณ ูู CSS
            }
            while (stream.next() != null && !stream.match(/\{\{.*?\}\}/, false)) {}
            return null;
        }
    };

    // --- ๐ก (ุชุนุฏูู) ุชููุฆุฉ ูุญุฑุฑุงุช CodeMirror ---
    const cmTranslateEditor = CodeMirror.fromTextArea(document.getElementById('translatePromptField'), {
        lineNumbers: true,
        lineWrapping: true,
        mode: "text/plain", // ุงููุถุน ุงูุฃุณุงุณู
        direction: "rtl", // <-- โโ (ุฅุถุงูุฉ) ุชูุนูู ุงุชุฌุงู ุงููููู ูููุณุงุฑ
        styleActiveLine: true // <-- โ (ุฅุถุงูุฉ) ุชุธููู ุงูุณุทุฑ ุงููุดุท
    });
    cmTranslateEditor.addOverlay(variableOverlay); // ุฅุถุงูุฉ ุชูููู ุงููุชุบูุฑุงุช

    const cmExtractEditor = CodeMirror.fromTextArea(document.getElementById('extractPromptField'), {
        lineNumbers: true,
        lineWrapping: true,
        mode: "text/plain",
        direction: "rtl", // <-- โโ (ุฅุถุงูุฉ) ุชูุนูู ุงุชุฌุงู ุงููููู ูููุณุงุฑ
        styleActiveLine: true // <-- โ (ุฅุถุงูุฉ) ุชุธููู ุงูุณุทุฑ ุงููุดุท
    });
    cmExtractEditor.addOverlay(variableOverlay); // ุฅุถุงูุฉ ุชูููู ุงููุชุบูุฑุงุช
    
    // --- ุฌูุจ ุจุงูู ุงูุนูุงุตุฑ ---
    const saveBtn = document.getElementById('saveBtn');
    const restoreBtn = document.getElementById('restoreBtn');
    const toast = document.getElementById('toast');

    // --- ุฏุงูุฉ ุนุฑุถ ุงูุฅุดุนุงุฑ (ูุณุชุนุงุฑุฉ) ---
    function showToast(message, type = 'success') {
        toast.textContent = message;
        toast.className = 'toast show';
        if (type === 'error') toast.classList.add('error');
        if (type === 'warning') toast.classList.add('warning');

        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => { toast.className = 'toast'; }, 500);
        }, 3000);
    }

    // --- ๐ก (ุชุนุฏูู) ุชุญููู ุงูุจุฑููุจุช ูู CodeMirror ---
    function loadPrompts() {
        const savedTranslate = Storage.get(CONFIG.STORAGE_KEYS.PROMPT_TRANSLATE);
        const savedExtract = Storage.get(CONFIG.STORAGE_KEYS.PROMPT_EXTRACT);

        cmTranslateEditor.setValue(savedTranslate || DEFAULT_TRANSLATION_PROMPT);
        cmExtractEditor.setValue(savedExtract || DEFAULT_EXTRACTION_PROMPT);
    }

    // --- ๐ก (ุชุนุฏูู) ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูู CodeMirror ---
    function savePrompts() {
        const newTranslate = cmTranslateEditor.getValue();
        const newExtract = cmExtractEditor.getValue();

        // ุงูุชุญูู ูู ูุฌูุฏ ุงููุชุบูุฑุงุช ุงููุทููุจุฉ
        if (!newTranslate.includes('{{TEXT}}') || !newTranslate.includes('{{GLOSSARY}}')) {
            showToast('โ ุฎุทุฃ: ุจุฑููุจุช ุงูุชุฑุฌูุฉ ูุฌุจ ุฃู ูุญุชูู ุนูู {{TEXT}} ู {{GLOSSARY}}', 'error');
            return;
        }

        if (!newExtract.includes('{{ENGLISH_TEXT}}') || !newExtract.includes('{{ARABIC_TEXT}}')) {
            showToast('โ ุฎุทุฃ: ุจุฑููุจุช ุงูุงุณุชุฎุฑุงุฌ ูุฌุจ ุฃู ูุญุชูู ุนูู {{ENGLISH_TEXT}} ู {{ARABIC_TEXT}}', 'error');
            return;
        }

        // ุงูุญูุธ
        Storage.set(CONFIG.STORAGE_KEYS.PROMPT_TRANSLATE, newTranslate);
        Storage.set(CONFIG.STORAGE_KEYS.PROMPT_EXTRACT, newExtract);

        showToast('โ ุชู ุญูุธ ุงูุฅุนุฏุงุฏุงุช ุจูุฌุงุญ!', 'success');
    }

    // --- ๐ก (ุชุนุฏูู) ุงุณุชุนุงุฏุฉ ุงูุงูุชุฑุงุถูุงุช ูู CodeMirror ---
    function restoreDefaults() {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุฑุบุจุชู ูู ุงุณุชุนุงุฏุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉุ ุณูุชู ุญุฐู ุฃู ุชุนุฏููุงุช ููุช ุจูุง.')) {
            // ุฅุฒุงูุฉ ุงูููุงุชูุญ ุงููุญููุธุฉ
            Storage.remove(CONFIG.STORAGE_KEYS.PROMPT_TRANSLATE);
            Storage.remove(CONFIG.STORAGE_KEYS.PROMPT_EXTRACT);
            
            // ุฅุนุงุฏุฉ ุชุญููู ุงูุงูุชุฑุงุถูุงุช ูู ุงูุญููู
            loadPrompts();
            
            showToast('โป๏ธ ุชู ุงุณุชุนุงุฏุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ', 'success');
        }
    }

    // --- ุฑุจุท ุงูุฃุญุฏุงุซ ---
    saveBtn.addEventListener('click', savePrompts);
    restoreBtn.addEventListener('click', restoreDefaults);

    // --- ุงูุชุญููู ุงูุฃููู ---
    loadPrompts();
});